---
import "../../styles/grid.css";
import { Image } from "astro:assets";
import RedirectedLink from "../RedirectedLink.astro";
import { galleryWidths } from "../../scripts/util.ts";
const { posts } = Astro.props;
---

<div class="grid">
  <div class="grid-sizer"></div>
  {
    posts.map((post) => {
      const widths = galleryWidths(post.data.media.length, 0);
      console.log(widths);

      return (
        <>
          {post.data.media.map((image, index) => {
            const w = widths[index];
            const z = Math.ceil(1000 * widths[index]);
            return (
              <div
                class="grid-item"
                data-id={post.id}
                data-index={index}
                style={`width: ${w * 100}%; z-index: ${z};`}
              >
                <div class="grid-item-content">
                  <Image
                    src={image}
                    alt={post.data.title}
                    title={post.data.title}
                  />
                </div>
              </div>
            );
          })}
          <div class="grid-item">
            <div class="grid-item-content">
              <ol>
                <li>
                  <RedirectedLink
                    href={`/${post.id}`}
                    title={post.data.title}
                    destination={post.data.redirect}
                  >
                    <span style="">{post.id}</span>
                  </RedirectedLink>
                </li>
              </ol>
            </div>
          </div>
          

          <div class="grid-item" style="height: 1rem; width: 100%;">
            <div class="grid-item-content">
              <span></span>
            </div>
          </div>
        </>
      );
    })
  }
</div>

<div id="data" data-target=".grid">
  <!-- <script src="./media.js"></script> -->
</div>
